var PasteTypeEnum={Microsoft_Excel:"Microsoft_Excel",Microsoft_Word:"Microsoft_Word",Microsoft_Publisher:"Microsoft_Publisher",Microsoft_OneNote:"Microsoft_OneNote",OpenOffice_Calc:"OpenOffice_Calc",OpenOffice_Writer:"OpenOffice_Writer",Html:"Html",Unknown:"Unknown"};function GetElement(e){return-1!=e.search("#")?document.getElementById(e.replace("#","")):-1!=e.search(".")?document.getElementById(e.replace(".","")):document.getElementsByTagName(e)}function LookFormat(e){var t=e.getData("text/html");return-1!=t.search("office:excel")?PasteTypeEnum.Microsoft_Excel:-1!=t.search("office:word")?PasteTypeEnum.Microsoft_Word:-1!=t.search("office:publisher")?PasteTypeEnum.Microsoft_Publisher:-1!=t.search("Microsoft OneNote")?PasteTypeEnum.Microsoft_OneNote:-1!=t.search("OpenOffice")&&-1!=t.search("TABLE")&&-1!=t.search("BODY TEXT")?PasteTypeEnum.OpenOffice_Calc:-1!=t.search("OpenOffice")&&-1!=t.search("BODY DIR")?PasteTypeEnum.OpenOffice_Writer:-1!=t.search("<html>")?PasteTypeEnum.Html:PasteTypeEnum.Unknown}function ExcelPureDataParser(e){var t=LookFormat(e);if(t===PasteTypeEnum.Microsoft_Excel||t===PasteTypeEnum.OpenOffice_Calc){for(var a=e.getData("text"),r=(a=a.trim()).split(String.fromCharCode(13)),o=0;o<r.length;o++)r[o]=r[o].trim().split(String.fromCharCode(9));return r}return Console.error("Excel or Calc format not recognized..."),null}function ExcelPureDataHeaderInjector(e,t){var a=ExcelPureDataParser(e);if(null===t)return a;var r=[],o=null;if(t.FirstColumnIsHeader)o=a[0];else{if(!t.InjectThisHeader||t.InjectThisHeader.constructor!==Array)return a;if(t.InjectThisHeader.length!=a[0].length)return console.warn("Desited inject on header count: "+t.InjectThisHeader.length),console.warn("Pasted data row cell count: "+t.InjectThisHeader.length),console.error("Desired inject on header and pasted data count not suitable for conversation of object array"),null;o=t.InjectThisHeader}for(var n=0;n<a.length;n++){for(var l={},c=0;c<o.length;c++)l[o[c]]=a[n][c];r.push(l)}return r}function PasteParser(e,t,a){GetElement(e).addEventListener("paste",function(e){var r=LookFormat(e.clipboardData);if(r===PasteTypeEnum.Microsoft_Excel){var o={type:PasteTypeEnum.Microsoft_Excel,pureText:e.clipboardData.getData("text"),pureHtml:e.clipboardData.getData("text/html"),pureExcelArray:ExcelPureDataParser(e.clipboardData),injectedExcelArray:ExcelPureDataHeaderInjector(e.clipboardData,t),domHtml:(new DOMParser).parseFromString(e.clipboardData.getData("text/html"),"text/html")};a(o)}else if(r===PasteTypeEnum.Microsoft_Word){o={type:PasteTypeEnum.Microsoft_Word,pureText:e.clipboardData.getData("text"),pureHtml:e.clipboardData.getData("text/html"),domHtml:(new DOMParser).parseFromString(e.clipboardData.getData("text/html"),"text/html")};a(o)}else if(r===PasteTypeEnum.Microsoft_Publisher){o={type:PasteTypeEnum.Microsoft_Publisher,pureText:e.clipboardData.getData("text"),pureHtml:e.clipboardData.getData("text/html"),domHtml:(new DOMParser).parseFromString(e.clipboardData.getData("text/html"),"text/html")};a(o)}else if(r===PasteTypeEnum.Microsoft_OneNote){o={type:PasteTypeEnum.Microsoft_OneNote,pureText:e.clipboardData.getData("text"),pureHtml:e.clipboardData.getData("text/html"),domHtml:(new DOMParser).parseFromString(e.clipboardData.getData("text/html"),"text/html")};a(o)}else if(r===PasteTypeEnum.OpenOffice_Calc){o={type:PasteTypeEnum.OpenOffice_Calc,pureText:e.clipboardData.getData("text"),pureHtml:e.clipboardData.getData("text/html"),pureExcelArray:ExcelPureDataParser(e.clipboardData),injectedExcelArray:ExcelPureDataHeaderInjector(e.clipboardData,t),domHtml:(new DOMParser).parseFromString(e.clipboardData.getData("text/html"),"text/html")};a(o)}else if(r===PasteTypeEnum.OpenOffice_Writer){o={type:PasteTypeEnum.OpenOffice_Writer,pureText:e.clipboardData.getData("text"),pureHtml:e.clipboardData.getData("text/html"),domHtml:(new DOMParser).parseFromString(e.clipboardData.getData("text/html"),"text/html")};a(o)}else if(r===PasteTypeEnum.Html){o={type:PasteTypeEnum.Html,pureText:e.clipboardData.getData("text"),pureHtml:e.clipboardData.getData("text/html"),domHtml:(new DOMParser).parseFromString(e.clipboardData.getData("text/html"),"text/html")};a(o)}else{o={type:PasteTypeEnum.Unknown,pureText:e.clipboardData.getData("text"),pureHtml:e.clipboardData.getData("text/html")};a(o)}})}