var PasteTypeEnum={Microsoft_Excel:"Microsoft_Excel",Microsoft_Word:"Microsoft_Word",Microsoft_Publisher:"Microsoft_Publisher",Microsoft_OneNote:"Microsoft_OneNote",OpenOffice_Calc:"OpenOffice_Calc",OpenOffice_Writer:"OpenOffice_Writer",Html:"Html",Unknown:"Unknown"};function GetElement(e){return e.includes("#")?document.getElementById(e.replace("#","")):e.includes(".")?document.getElementsByClassName(e.replace(".",""))[0]:document.getElementsByTagName(e)[0]}function LookFormat(e){var t=e.getData("text/html");return t.includes("office:excel")?PasteTypeEnum.Microsoft_Excel:t.includes("office:word")?PasteTypeEnum.Microsoft_Word:t.includes("office:publisher")?PasteTypeEnum.Microsoft_Publisher:t.includes("Microsoft OneNote")?PasteTypeEnum.Microsoft_OneNote:t.includes("OpenOffice")&&t.includes("TABLE")&&t.includes("BODY TEXT")?PasteTypeEnum.OpenOffice_Calc:t.includes("OpenOffice")&&t.includes("BODY DIR")?PasteTypeEnum.OpenOffice_Writer:t.includes("<html>")?PasteTypeEnum.Html:PasteTypeEnum.Unknown}function ExcelPureDataParser(e){var t=LookFormat(e);if(t===PasteTypeEnum.Microsoft_Excel||t===PasteTypeEnum.OpenOffice_Calc){for(var a=e.getData("text"),r=(a=a.trim()).split(String.fromCharCode(13)),o=0;o<r.length;o++)r[o]=r[o].trim().split(String.fromCharCode(9));return r}return Console.error("Excel or Calc format not recognized..."),null}function ExcelPureDataHeaderInjector(e,t){var a=ExcelPureDataParser(e);if(null===t)return a;var r=[],o=null;if(t.FirstColumnIsHeader)o=a[0];else{if(!t.InjectThisHeader||t.InjectThisHeader.constructor!==Array)return a;if(t.InjectThisHeader.length!=a[0].length)return console.warn("Desited inject on header count: "+t.InjectThisHeader.length),console.warn("Pasted data row cell count: "+t.InjectThisHeader.length),console.error("Desired inject on header and pasted data count not suitable for conversation of object array"),null;o=t.InjectThisHeader}for(var l=0;l<a.length;l++){for(var n={},c=0;c<o.length;c++)n[o[c]]=a[l][c];r.push(n)}return t.FirstColumnIsHeader&&r.splice(0,1),r}function PasteParser(e,t,a){GetElement(e).addEventListener("paste",function(e){var r=LookFormat(e.clipboardData);if(r===PasteTypeEnum.Microsoft_Excel){var o={type:PasteTypeEnum.Microsoft_Excel,pureText:e.clipboardData.getData("text"),pureHtml:e.clipboardData.getData("text/html"),pureExcelArray:ExcelPureDataParser(e.clipboardData),injectedExcelArray:ExcelPureDataHeaderInjector(e.clipboardData,t),domHtml:(new DOMParser).parseFromString(e.clipboardData.getData("text/html"),"text/html")};a(o)}else if(r===PasteTypeEnum.Microsoft_Word){o={type:PasteTypeEnum.Microsoft_Word,pureText:e.clipboardData.getData("text"),pureHtml:e.clipboardData.getData("text/html"),domHtml:(new DOMParser).parseFromString(e.clipboardData.getData("text/html"),"text/html")};a(o)}else if(r===PasteTypeEnum.Microsoft_Publisher){o={type:PasteTypeEnum.Microsoft_Publisher,pureText:e.clipboardData.getData("text"),pureHtml:e.clipboardData.getData("text/html"),domHtml:(new DOMParser).parseFromString(e.clipboardData.getData("text/html"),"text/html")};a(o)}else if(r===PasteTypeEnum.Microsoft_OneNote){o={type:PasteTypeEnum.Microsoft_OneNote,pureText:e.clipboardData.getData("text"),pureHtml:e.clipboardData.getData("text/html"),domHtml:(new DOMParser).parseFromString(e.clipboardData.getData("text/html"),"text/html")};a(o)}else if(r===PasteTypeEnum.OpenOffice_Calc){o={type:PasteTypeEnum.OpenOffice_Calc,pureText:e.clipboardData.getData("text"),pureHtml:e.clipboardData.getData("text/html"),pureExcelArray:ExcelPureDataParser(e.clipboardData),injectedExcelArray:ExcelPureDataHeaderInjector(e.clipboardData,t),domHtml:(new DOMParser).parseFromString(e.clipboardData.getData("text/html"),"text/html")};a(o)}else if(r===PasteTypeEnum.OpenOffice_Writer){o={type:PasteTypeEnum.OpenOffice_Writer,pureText:e.clipboardData.getData("text"),pureHtml:e.clipboardData.getData("text/html"),domHtml:(new DOMParser).parseFromString(e.clipboardData.getData("text/html"),"text/html")};a(o)}else if(r===PasteTypeEnum.Html){o={type:PasteTypeEnum.Html,pureText:e.clipboardData.getData("text"),pureHtml:e.clipboardData.getData("text/html"),domHtml:(new DOMParser).parseFromString(e.clipboardData.getData("text/html"),"text/html")};a(o)}else{o={type:PasteTypeEnum.Unknown,pureText:e.clipboardData.getData("text"),pureHtml:e.clipboardData.getData("text/html")};a(o)}})}
